<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bbs.demo.mapper.CommentMapper">

	<select id="getCommentsByPostId" resultType="">
		SELECT c.comment_id,
		c.comment, c.post_id, u.user_id, u.username, c.created_at,
		c.updated_at
		FROM comments c
		JOIN users u ON c.user_id = u.user_id
		WHERE
		c.post_id = #{postId}
	</select>

	<insert id="insertComment">
		INSERT INTO comments(comment, post_id, user_id,
		created_at, updated_at)
		VALUES(#{comment}, #{postId}, #{userId}, NOW(),
		NOW())
	</insert>

	<update id="updateComment">
		UPDATE comments
		SET comment = #{comment}, updated_at =
		NOW()
		WHERE comment_id = #{commentId}
	</update>

	<delete id="deleteComment">
		DELETE FROM comments
		WHERE comment_id = #{id} AND
		user_id = #{userId}
	</delete>

	<select id="getCommentById" resultType="">
		SELECT * FROM comments
		WHERE comment_id = #{id}
	</select>

</mapper>